<?phpdefined('BASEPATH') OR exit('No direct script access allowed');class Excel extends CI_Controller {		function __construct(){		parent::__construct();				$this->load->model('model_cetak');        $this->load->helper('url');	}		public function index(){		redirect(base_url());    }	public function laporangedung($filtertabel){		if($this->session->userdata('username') != '') {				$pecah = explode("-",$filtertabel);				if($pecah[0] > 12 && $pecah[0] < 1 ){					redirect(base_url());				}else{					switch($pecah[0]){					case "1":					$bulan = "JANUARI";break;					case "2":					$bulan = "FEBRUARI";break;					case "3":					$bulan = "MARET";break;					case "4":					$bulan = "APRIL";break;					case "5":					$bulan = "MEI";break;					case "6":					$bulan = "JUNI";break;					case "7":					$bulan = "JULI";break;					case "8":					$bulan = "AGUSTUS";break;					case "9":					$bulan = "SEPTEMBER";break;					case "10":					$bulan = "OKTOBER";break;					case "11":					$bulan = "NOVEMBER";break;					case "12":					$bulan = "DESEMBER";break;					default : $bulan = "ETC";break;					}					$filter = array('month(Waktu_Report)' => $pecah[0], 'year(Waktu_Report)' => $pecah[1]);					$alias = "month(Waktu_Report) as bulan, year(Waktu_Report) as tahun";										include APPPATH.'third_party/PHPExcel/Classes/PHPExcel.php';					// Panggil class PHPExcel nya					$excel = new PHPExcel();					// Settingan awal fil excel					$excel->getProperties()->setCreator('Infoglobal')								 ->setTitle("Laporan GA");					// Buat sebuah variabel untuk menampung pengaturan style dari header tabel					$style_judul = array(					  'font' => array('bold' => true), // Set font nya jadi bold					  'alignment' => array(						'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					 );					// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel					$style_text = array(					  'alignment' => array(						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					);					$style = array(					  'alignment' => array(						'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					);					$excel->setActiveSheetIndex(0)->setCellValue('A1', "LAPORAN KONDISI GEDUNG PT INFOGLOBAL PADA BULAN ".$bulan." TAHUN ".$pecah[1]); // Set kolom A1 dengan tulisan "DATA SISWA"					$excel->getActiveSheet()->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai E1					$excel->getActiveSheet()->getStyle('A1')->getFont()->setBold(TRUE); // Set bold kolom A1					$excel->getActiveSheet()->getStyle('A1')->getFont()->setSize(15); // Set font size 15 untuk kolom A1					$excel->getActiveSheet()->getStyle('A1')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER); // Set text center untuk kolom A1					// Buat header tabel nya pada baris ke 3					$excel->setActiveSheetIndex(0)->setCellValue('A3', "NO"); // Set kolom A3 dengan tulisan "NO"					$excel->setActiveSheetIndex(0)->setCellValue('B3', "NAMA RUANGAN"); // Set kolom B3 dengan tulisan "NIS"					$excel->setActiveSheetIndex(0)->setCellValue('C3', "KONDISI RUANGAN"); // Set kolom C3 dengan tulisan "NAMA"					$excel->setActiveSheetIndex(0)->setCellValue('D3', "STATUS"); // Set kolom D3 dengan tulisan "JENIS KELAMIN"					$excel->setActiveSheetIndex(0)->setCellValue('E3', "CATATAN GENERAL AFFAIRS"); // Set kolom E3 dengan tulisan "ALAMAT"					$excel->setActiveSheetIndex(0)->setCellValue('F3', "SARAN"); // Set kolom E3 dengan tulisan "ALAMAT"					// Apply style header yang telah kita buat tadi ke masing-masing kolom header					$excel->getActiveSheet()->getStyle('A3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('B3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('C3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('D3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('E3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('F3')->applyFromArray($style_judul);					// Panggil function view yang ada di SiswaModel untuk menampilkan semua data siswanya					$gedung = $this->model_cetak->tampil_datacetak('kondisi_gedung',$filter,'Nama_Ruangan',$alias);					$no = 1; // Untuk penomoran tabel, di awal set dengan 1					$numrow = 4; // Set baris pertama untuk isi tabel adalah baris ke 4					foreach($gedung as $data){ // Lakukan looping pada variabel siswa					  $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $no);					  $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data->Nama_Ruangan);					  $excel->setActiveSheetIndex(0)->setCellValue('C'.$numrow, $data->Kondisi_Ruangan);					  $excel->setActiveSheetIndex(0)->setCellValue('D'.$numrow, $data->Status_Ruangan);					  $excel->setActiveSheetIndex(0)->setCellValue('E'.$numrow, $data->Catatan_GA_Ruangan);					  $excel->setActiveSheetIndex(0)->setCellValue('F'.$numrow, $data->Saran_Ruangan);					  					  // Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)					  $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('C'.$numrow)->applyFromArray($style_text);					  $excel->getActiveSheet()->getStyle('D'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('E'.$numrow)->applyFromArray($style_text);					  $excel->getActiveSheet()->getStyle('F'.$numrow)->applyFromArray($style_text);					  					  $no++; // Tambah 1 setiap kali looping					  $numrow++; // Tambah 1 setiap kali looping					}					// Set width kolom					$excel->getActiveSheet()->getColumnDimension('A')->setWidth(5); // Set width kolom A					$excel->getActiveSheet()->getColumnDimension('B')->setWidth(30); // Set width kolom B					$excel->getActiveSheet()->getColumnDimension('C')->setWidth(25); // Set width kolom C					$excel->getActiveSheet()->getColumnDimension('D')->setWidth(20); // Set width kolom D					$excel->getActiveSheet()->getColumnDimension('E')->setWidth(30); // Set width kolom E					$excel->getActiveSheet()->getColumnDimension('F')->setWidth(30); // Set width kolom E										// Set height semua kolom menjadi auto (mengikuti height isi dari kolommnya, jadi otomatis)					$excel->getActiveSheet()->getDefaultRowDimension()->setRowHeight(-1);					// Set orientasi kertas jadi LANDSCAPE					$excel->getActiveSheet()->getPageSetup()->setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_LANDSCAPE);					// Set judul file excel nya					$excel->getActiveSheet(0)->setTitle("Laporan Kondisi Gedung");					$excel->setActiveSheetIndex(0);					// Proses file excel					header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');					$namapdf = 'Laporan Kondisi Gedung ['.$bulan.'-'.$pecah[1].'].xlsx';					header('Content-Disposition: attachment; filename="'.$namapdf.'"'); // Set nama file excel nya					header('Cache-Control: max-age=0');					$write = PHPExcel_IOFactory::createWriter($excel, 'Excel2007');					$write->save('php://output');				}        }        else {            redirect(base_url());        }	}	public function laporanbiayakantor($filtertabel){		if($this->session->userdata('username') != '') {				$pecah = explode("-",$filtertabel);				if($pecah[0] > 12 && $pecah[0] < 1 ){					redirect(base_url());				}else{										switch($pecah[0]){					case "1":					$bulan = "JANUARI";break;					case "2":					$bulan = "FEBRUARI";break;					case "3":					$bulan = "MARET";break;					case "4":					$bulan = "APRIL";break;					case "5":					$bulan = "MEI";break;					case "6":					$bulan = "JUNI";break;					case "7":					$bulan = "JULI";break;					case "8":					$bulan = "AGUSTUS";break;					case "9":					$bulan = "SEPTEMBER";break;					case "10":					$bulan = "OKTOBER";break;					case "11":					$bulan = "NOVEMBER";break;					case "12":					$bulan = "DESEMBER";break;					default : $bulan = "ETC";break;					}					$filter = array('month(Tgl_Pembayaran)' => $pecah[0], 'year(Tgl_Pembayaran)' => $pecah[1]);					$alias = "month(Tgl_Pembayaran) as bulan, year(Tgl_Pembayaran) as tahun";										include APPPATH.'third_party/PHPExcel/Classes/PHPExcel.php';					// Panggil class PHPExcel nya					$excel = new PHPExcel();					// Settingan awal fil excel					$excel->getProperties()->setCreator('Infoglobal')								 ->setTitle("Laporan GA");					// Buat sebuah variabel untuk menampung pengaturan style dari header tabel					$style_judul = array(					  'font' => array('bold' => true), // Set font nya jadi bold					  'alignment' => array(						'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					 );					// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel					$style_text = array(					  'alignment' => array(						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					);					$style_kanan = array(					  'alignment' => array(					    'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_RIGHT, // Set text jadi ditengah secara horizontal (center)						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					);					$style = array(					  'alignment' => array(						'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					);					$excel->setActiveSheetIndex(0)->setCellValue('A1', "LAPORAN KONDISI BIAYA KANTOR PT INFOGLOBAL PADA BULAN ".$bulan." TAHUN ".$pecah[1]); // Set kolom A1 dengan tulisan "DATA SISWA"					$excel->getActiveSheet()->mergeCells('A1:F1'); // Set Merge Cell pada kolom A1 sampai E1					$excel->getActiveSheet()->getStyle('A1')->getFont()->setBold(TRUE); // Set bold kolom A1					$excel->getActiveSheet()->getStyle('A1')->getFont()->setSize(15); // Set font size 15 untuk kolom A1					$excel->getActiveSheet()->getStyle('A1')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER); // Set text center untuk kolom A1					// Buat header tabel nya pada baris ke 3					$excel->setActiveSheetIndex(0)->setCellValue('A3', "NO"); 					$excel->setActiveSheetIndex(0)->setCellValue('B3', "NAMA KEBUTUHAN"); 					$excel->setActiveSheetIndex(0)->setCellValue('C3', "TANGGAL PEMBAYARAN"); 					$excel->setActiveSheetIndex(0)->setCellValue('D3', "HARGA PEMBAYARAN(Rp)"); 					// Apply style header yang telah kita buat tadi ke masing-masing kolom header					$excel->getActiveSheet()->getStyle('A3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('B3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('C3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('D3')->applyFromArray($style_judul);					// Panggil function view yang ada di SiswaModel untuk menampilkan semua data siswanya					$biayakantor = $this->model_cetak->tampil_datacetak('pembayaran_kantor',$filter,'Nama_Pembayaran',$alias);					$no = 1; // Untuk penomoran tabel, di awal set dengan 1					$numrow = 4; // Set baris pertama untuk isi tabel adalah baris ke 4					foreach($biayakantor as $data){ // Lakukan looping pada variabel siswa					  $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $no);					  $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data->Nama_Pembayaran);					  $excel->setActiveSheetIndex(0)->setCellValue('C'.$numrow, date("d F Y", strtotime($data->Tgl_Pembayaran)));					  $excel->setActiveSheetIndex(0)->setCellValue('D'.$numrow, $data->Total_Pembayaran);					  					  // Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)					  $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('C'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('D'.$numrow)->applyFromArray($style_kanan);					  					  $no++; // Tambah 1 setiap kali looping					  $numrow++; // Tambah 1 setiap kali looping					  $barisakhir = $numrow;					}					$excel->setActiveSheetIndex(0)->setCellValue('A'.$barisakhir, 'Total Pembayaran Kantor(Rp)'); // Set kolom A1 dengan tulisan "DATA SISWA"					$excel->getActiveSheet()->mergeCells('A'.$barisakhir.':C'.$barisakhir); // Set Merge Cell pada kolom A1 sampai E1					$excel->getActiveSheet()->getStyle('A'.$barisakhir)->applyFromArray($style);					$excel->getActiveSheet()->getStyle('B'.$barisakhir)->applyFromArray($style);					$excel->getActiveSheet()->getStyle('C'.$barisakhir)->applyFromArray($style);					$excel->getActiveSheet()->getStyle('A'.$barisakhir)->getFont()->setBold(TRUE); // Set bold kolom A1					$excel->setActiveSheetIndex(0)->setCellValue('D'.$barisakhir, "=SUM(D4:D".($barisakhir-1).")");					$excel->getActiveSheet()->getStyle('D'.$barisakhir)->applyFromArray($style_kanan);					// Set width kolom					$excel->getActiveSheet()->getColumnDimension('A')->setWidth(5); // Set width kolom A					$excel->getActiveSheet()->getColumnDimension('B')->setWidth(30); // Set width kolom B					$excel->getActiveSheet()->getColumnDimension('C')->setWidth(25); // Set width kolom C					$excel->getActiveSheet()->getColumnDimension('D')->setWidth(30); // Set width kolom E										// Set height semua kolom menjadi auto (mengikuti height isi dari kolommnya, jadi otomatis)					$excel->getActiveSheet()->getDefaultRowDimension()->setRowHeight(-1);					// Set orientasi kertas jadi LANDSCAPE					$excel->getActiveSheet()->getPageSetup()->setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_LANDSCAPE);					// Set judul file excel nya					$excel->getActiveSheet(0)->setTitle("Laporan Biaya Kantor");					$excel->setActiveSheetIndex(0);					// Proses file excel					header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');					$namapdf = 'Laporan Biaya Kantor ['.$bulan.'-'.$pecah[1].'].xlsx';					header('Content-Disposition: attachment; filename="'.$namapdf.'"'); // Set nama file excel nya					header('Cache-Control: max-age=0');					$write = PHPExcel_IOFactory::createWriter($excel, 'Excel2007');					$write->save('php://output');									}        }        else {            redirect(base_url());        }	}	public function laporanbiayarumahtangga($filtertabel){		if($this->session->userdata('username') != '') {				$pecah = explode("-",$filtertabel);				if($pecah[0] > 12 && $pecah[0] < 1 ){					redirect(base_url());				}else{					switch($pecah[0]){					case "1":					$bulan = "JANUARI";break;					case "2":					$bulan = "FEBRUARI";break;					case "3":					$bulan = "MARET";break;					case "4":					$bulan = "APRIL";break;					case "5":					$bulan = "MEI";break;					case "6":					$bulan = "JUNI";break;					case "7":					$bulan = "JULI";break;					case "8":					$bulan = "AGUSTUS";break;					case "9":					$bulan = "SEPTEMBER";break;					case "10":					$bulan = "OKTOBER";break;					case "11":					$bulan = "NOVEMBER";break;					case "12":					$bulan = "DESEMBER";break;					default : $bulan = "ETC";break;					}					$filter = array('month(Tgl_Beli)' => $pecah[0], 'year(Tgl_Beli)' => $pecah[1]);					$alias = "month(Tgl_Beli) as bulan, year(Tgl_Beli) as tahun";										include APPPATH.'third_party/PHPExcel/Classes/PHPExcel.php';					// Panggil class PHPExcel nya					$excel = new PHPExcel();					// Settingan awal fil excel					$excel->getProperties()->setCreator('Infoglobal')								 ->setTitle("Laporan GA");					// Buat sebuah variabel untuk menampung pengaturan style dari header tabel					$style_judul = array(					  'font' => array('bold' => true), // Set font nya jadi bold					  'alignment' => array(						'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					 );					// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel					$style_text = array(					  'alignment' => array(						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					);					$style_kanan = array(					  'alignment' => array(					    'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_RIGHT, // Set text jadi ditengah secara horizontal (center)						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					);					$style = array(					  'alignment' => array(						'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					);					$excel->setActiveSheetIndex(0)->setCellValue('A1', "LAPORAN KONDISI BIAYA RUMAH TANGGA PT INFOGLOBAL PADA BULAN ".$bulan." TAHUN ".$pecah[1]); // Set kolom A1 dengan tulisan "DATA SISWA"					$excel->getActiveSheet()->mergeCells('A1:E1'); // Set Merge Cell pada kolom A1 sampai E1					$excel->getActiveSheet()->getStyle('A1')->getFont()->setBold(TRUE); // Set bold kolom A1					$excel->getActiveSheet()->getStyle('A1')->getFont()->setSize(15); // Set font size 15 untuk kolom A1					$excel->getActiveSheet()->getStyle('A1')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER); // Set text center untuk kolom A1					// Buat header tabel nya pada baris ke 3					$excel->setActiveSheetIndex(0)->setCellValue('A3', "NO"); // Set kolom A3 dengan tulisan "NO"					$excel->setActiveSheetIndex(0)->setCellValue('B3', "NAMA BARANG"); // Set kolom B3 dengan tulisan "NIS"					$excel->setActiveSheetIndex(0)->setCellValue('C3', "JUMLAH BARANG"); // Set kolom C3 dengan tulisan "NAMA"					$excel->setActiveSheetIndex(0)->setCellValue('D3', "TANGGAL PEMBELIAN"); // Set kolom D3 dengan tulisan "JENIS KELAMIN"					$excel->setActiveSheetIndex(0)->setCellValue('E3', "TOTAL PEMBAYARAN(Rp)"); // Set kolom E3 dengan tulisan "ALAMAT"					// Apply style header yang telah kita buat tadi ke masing-masing kolom header					$excel->getActiveSheet()->getStyle('A3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('B3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('C3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('D3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('E3')->applyFromArray($style_judul);					// Panggil function view yang ada di SiswaModel untuk menampilkan semua data siswanya					$biayarumahtangga = $this->model_cetak->tampil_datacetak('pembayaran_rumahtangga',$filter,'Nama_Barang',$alias);					$no = 1; // Untuk penomoran tabel, di awal set dengan 1					$numrow = 4; // Set baris pertama untuk isi tabel adalah baris ke 4					foreach($biayarumahtangga as $data){ // Lakukan looping pada variabel siswa					  $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $no);					  $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data->Nama_Barang);					  $excel->setActiveSheetIndex(0)->setCellValue('C'.$numrow, $data->Jumlah_Barang);					  $excel->setActiveSheetIndex(0)->setCellValue('D'.$numrow, date("d F Y", strtotime($data->Tgl_Beli)));					  $excel->setActiveSheetIndex(0)->setCellValue('E'.$numrow, $data->Total_Harga);					  					  // Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)					  $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('C'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('D'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('E'.$numrow)->applyFromArray($style_kanan);					  					  $no++; // Tambah 1 setiap kali looping					  $numrow++; // Tambah 1 setiap kali looping					  $barisakhir = $numrow;					}					$excel->setActiveSheetIndex(0)->setCellValue('A'.$barisakhir, 'Total Pembayaran Rumah Tangga(Rp)'); // Set kolom A1 dengan tulisan "DATA SISWA"					$excel->getActiveSheet()->mergeCells('A'.$barisakhir.':D'.$barisakhir); // Set Merge Cell pada kolom A1 sampai E1					$excel->getActiveSheet()->getStyle('A'.$barisakhir)->applyFromArray($style);					$excel->getActiveSheet()->getStyle('B'.$barisakhir)->applyFromArray($style);					$excel->getActiveSheet()->getStyle('C'.$barisakhir)->applyFromArray($style);					$excel->getActiveSheet()->getStyle('D'.$barisakhir)->applyFromArray($style);					$excel->getActiveSheet()->getStyle('A'.$barisakhir)->getFont()->setBold(TRUE); // Set bold kolom A1					$excel->setActiveSheetIndex(0)->setCellValue('E'.$barisakhir, "=SUM(E4:E".($barisakhir-1).")");					$excel->getActiveSheet()->getStyle('E'.$barisakhir)->applyFromArray($style_kanan);					// Set width kolom					$excel->getActiveSheet()->getColumnDimension('A')->setWidth(5); // Set width kolom A					$excel->getActiveSheet()->getColumnDimension('B')->setWidth(30); // Set width kolom B					$excel->getActiveSheet()->getColumnDimension('C')->setWidth(25); // Set width kolom C					$excel->getActiveSheet()->getColumnDimension('D')->setWidth(20); // Set width kolom D					$excel->getActiveSheet()->getColumnDimension('E')->setWidth(30); // Set width kolom E										// Set height semua kolom menjadi auto (mengikuti height isi dari kolommnya, jadi otomatis)					$excel->getActiveSheet()->getDefaultRowDimension()->setRowHeight(-1);					// Set orientasi kertas jadi LANDSCAPE					$excel->getActiveSheet()->getPageSetup()->setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_LANDSCAPE);					// Set judul file excel nya					$excel->getActiveSheet(0)->setTitle("Laporan Biaya Rumah Tangga");					$excel->setActiveSheetIndex(0);					// Proses file excel					header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');					$namapdf = 'Laporan Biaya Rumah Tangga ['.$bulan.'-'.$pecah[1].'].xlsx';					header('Content-Disposition: attachment; filename="'.$namapdf.'"'); // Set nama file excel nya					header('Cache-Control: max-age=0');					$write = PHPExcel_IOFactory::createWriter($excel, 'Excel2007');					$write->save('php://output');				}        }        else {            redirect(base_url());        }	}	public function laporanbarang($filtertabel){		if($this->session->userdata('username') != '') {				$pecah = explode("-",$filtertabel);								if($pecah[0] > 12 && $pecah[0] < 1 ){										redirect(base_url());				}else{					switch($pecah[0]){					case "1":					$bulan = "JANUARI";break;					case "2":					$bulan = "FEBRUARI";break;					case "3":					$bulan = "MARET";break;					case "4":					$bulan = "APRIL";break;					case "5":					$bulan = "MEI";break;					case "6":					$bulan = "JUNI";break;					case "7":					$bulan = "JULI";break;					case "8":					$bulan = "AGUSTUS";break;					case "9":					$bulan = "SEPTEMBER";break;					case "10":					$bulan = "OKTOBER";break;					case "11":					$bulan = "NOVEMBER";break;					case "12":					$bulan = "DESEMBER";break;					default : $bulan = "ETC";break;					}					$filter = array('month(Waktu_Report)' => $pecah[0], 'year(Waktu_Report)' => $pecah[1]);					$alias = "month(Waktu_Report) as bulan, year(Waktu_Report) as tahun";										include APPPATH.'third_party/PHPExcel/Classes/PHPExcel.php';					// Panggil class PHPExcel nya					$excel = new PHPExcel();					// Settingan awal fil excel					$excel->getProperties()->setCreator('Infoglobal')								 ->setTitle("Laporan GA");					// Buat sebuah variabel untuk menampung pengaturan style dari header tabel					$style_judul = array(					  'font' => array('bold' => true), // Set font nya jadi bold					  'alignment' => array(						'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					 );					// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel					$style_text = array(					  'alignment' => array(						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					);					$style_kanan = array(					  'alignment' => array(					    'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_RIGHT, // Set text jadi ditengah secara horizontal (center)						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					);					$style = array(					  'alignment' => array(						'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					);					$excel->setActiveSheetIndex(0)->setCellValue('A1', "LAPORAN KONDISI BARANG PT INFOGLOBAL PADA BULAN ".$bulan." TAHUN ".$pecah[1]); // Set kolom A1 dengan tulisan "DATA SISWA"					$excel->getActiveSheet()->mergeCells('A1:H1'); // Set Merge Cell pada kolom A1 sampai E1					$excel->getActiveSheet()->getStyle('A1')->getFont()->setBold(TRUE); // Set bold kolom A1					$excel->getActiveSheet()->getStyle('A1')->getFont()->setSize(15); // Set font size 15 untuk kolom A1					$excel->getActiveSheet()->getStyle('A1')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER); // Set text center untuk kolom A1					// Buat header tabel nya pada baris ke 3					$excel->setActiveSheetIndex(0)->setCellValue('A3', "NO"); 					$excel->setActiveSheetIndex(0)->setCellValue('B3', "NAMA BARANG"); 					$excel->setActiveSheetIndex(0)->setCellValue('C3', "JUMLAH"); 					$excel->setActiveSheetIndex(0)->setCellValue('D3', "STATUS BARANG"); 					$excel->setActiveSheetIndex(0)->setCellValue('E3', "KEADAAN / KONDISI BARANG"); 					$excel->setActiveSheetIndex(0)->setCellValue('F3', "CATATAN GA");					$excel->setActiveSheetIndex(0)->setCellValue('G3', "SARAN");					$excel->setActiveSheetIndex(0)->setCellValue('H3', "WAKTU REPORT");					// Apply style header yang telah kita buat tadi ke masing-masing kolom header					$excel->getActiveSheet()->getStyle('A3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('B3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('C3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('D3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('E3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('F3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('G3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('H3')->applyFromArray($style_judul);					// Panggil function view yang ada di SiswaModel untuk menampilkan semua data siswanya					$kondisibarang = $this->model_cetak->tampil_datacetak('kondisi_barang',$filter,'Nama_Barang', $alias);					$no = 1; // Untuk penomoran tabel, di awal set dengan 1					$numrow = 4; // Set baris pertama untuk isi tabel adalah baris ke 4					foreach($kondisibarang as $data){ // Lakukan looping pada variabel siswa					  $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $no);					  $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data->Nama_Barang);					  $excel->setActiveSheetIndex(0)->setCellValue('C'.$numrow, $data->Jumlah_Barang);					  $excel->setActiveSheetIndex(0)->setCellValue('D'.$numrow, $data->Status_Barang);					  $excel->setActiveSheetIndex(0)->setCellValue('E'.$numrow, $data->Kondisi_Barang);					  $excel->setActiveSheetIndex(0)->setCellValue('F'.$numrow, $data->Catatan_GA_Barang);					  $excel->setActiveSheetIndex(0)->setCellValue('G'.$numrow, $data->Saran_Barang);					  $excel->setActiveSheetIndex(0)->setCellValue('H'.$numrow, date("d F Y", strtotime($data->Waktu_Report)));					  // Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)					  $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('C'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('D'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('E'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('F'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('G'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('H'.$numrow)->applyFromArray($style);					  					  $no++; // Tambah 1 setiap kali looping					  $numrow++; // Tambah 1 setiap kali looping					  $barisakhir = $numrow;					}										// Set width kolom					$excel->getActiveSheet()->getColumnDimension('A')->setWidth(5); // Set width kolom A					$excel->getActiveSheet()->getColumnDimension('B')->setWidth(30); // Set width kolom B					$excel->getActiveSheet()->getColumnDimension('C')->setWidth(25); // Set width kolom C					$excel->getActiveSheet()->getColumnDimension('D')->setWidth(20); // Set width kolom D					$excel->getActiveSheet()->getColumnDimension('E')->setWidth(30); // Set width kolom E					$excel->getActiveSheet()->getColumnDimension('F')->setWidth(30); // Set width kolom F					$excel->getActiveSheet()->getColumnDimension('G')->setWidth(30); // Set width kolom G					$excel->getActiveSheet()->getColumnDimension('H')->setWidth(30); // Set width kolom H										// Set height semua kolom menjadi auto (mengikuti height isi dari kolommnya, jadi otomatis)					$excel->getActiveSheet()->getDefaultRowDimension()->setRowHeight(-1);					// Set orientasi kertas jadi LANDSCAPE					$excel->getActiveSheet()->getPageSetup()->setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_LANDSCAPE);					// Set judul file excel nya					$excel->getActiveSheet(0)->setTitle("Laporan Kondisi Barang");					$excel->setActiveSheetIndex(0);					// Proses file excel					header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');					$namapdf = 'Laporan Kondisi Barang ['.$bulan.'-'.$pecah[1].'].xlsx';					header('Content-Disposition: attachment; filename="'.$namapdf.'"'); // Set nama file excel nya					header('Cache-Control: max-age=0');					$write = PHPExcel_IOFactory::createWriter($excel, 'Excel2007');					$write->save('php://output');									}        }        else {            redirect(base_url());        }	}	public function laporankendaraan($filtertabel){		if($this->session->userdata('username') != '') {				$pecah = explode("-",$filtertabel);				if($pecah[0] > 12 && $pecah[0] < 1 ){					redirect(base_url());				}else{				switch($pecah[0]){					case "1":					$bulan = "JANUARI";break;					case "2":					$bulan = "FEBRUARI";break;					case "3":					$bulan = "MARET";break;					case "4":					$bulan = "APRIL";break;					case "5":					$bulan = "MEI";break;					case "6":					$bulan = "JUNI";break;					case "7":					$bulan = "JULI";break;					case "8":					$bulan = "AGUSTUS";break;					case "9":					$bulan = "SEPTEMBER";break;					case "10":					$bulan = "OKTOBER";break;					case "11":					$bulan = "NOVEMBER";break;					case "12":					$bulan = "DESEMBER";break;					default : $bulan = "ETC";break;					}					$filter = array('month(Waktu_Report)' => $pecah[0], 'year(Waktu_Report)' => $pecah[1]);					$alias = "month(Waktu_Report) as bulan, year(Waktu_Report) as tahun";										include APPPATH.'third_party/PHPExcel/Classes/PHPExcel.php';					// Panggil class PHPExcel nya					$excel = new PHPExcel();					// Settingan awal fil excel					$excel->getProperties()->setCreator('Infoglobal')								 ->setTitle("Laporan GA");					// Buat sebuah variabel untuk menampung pengaturan style dari header tabel					$style_judul = array(					  'font' => array('bold' => true), // Set font nya jadi bold					  'alignment' => array(						'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					 );					// Buat sebuah variabel untuk menampung pengaturan style dari isi tabel					$style_text = array(					  'alignment' => array(						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					);					$style_kanan = array(					  'alignment' => array(					    'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_RIGHT, // Set text jadi ditengah secara horizontal (center)						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					);					$style = array(					  'alignment' => array(						'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER, // Set text jadi ditengah secara horizontal (center)						'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER // Set text jadi di tengah secara vertical (middle)					  ),					  'borders' => array(						'top' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border top dengan garis tipis						'right' => array('style'  => PHPExcel_Style_Border::BORDER_THIN),  // Set border right dengan garis tipis						'bottom' => array('style'  => PHPExcel_Style_Border::BORDER_THIN), // Set border bottom dengan garis tipis						'left' => array('style'  => PHPExcel_Style_Border::BORDER_THIN) // Set border left dengan garis tipis					  )					);					$excel->setActiveSheetIndex(0)->setCellValue('A1', "LAPORAN KONDISI KENDARAAN PT INFOGLOBAL PADA BULAN ".$bulan." TAHUN ".$pecah[1]); // Set kolom A1 dengan tulisan "DATA SISWA"					$excel->getActiveSheet()->mergeCells('A1:L1'); // Set Merge Cell pada kolom A1 sampai E1					$excel->getActiveSheet()->getStyle('A1')->getFont()->setBold(TRUE); // Set bold kolom A1					$excel->getActiveSheet()->getStyle('A1')->getFont()->setSize(15); // Set font size 15 untuk kolom A1					$excel->getActiveSheet()->getStyle('A1')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER); // Set text center untuk kolom A1					// Buat header tabel nya pada baris ke 3					$excel->setActiveSheetIndex(0)->setCellValue('A3', "NO"); 					$excel->getActiveSheet()->mergeCells('A3:A4');					$excel->setActiveSheetIndex(0)->setCellValue('B3', "NAMA KENDARAAN"); 					$excel->getActiveSheet()->mergeCells('B3:B4');					$excel->setActiveSheetIndex(0)->setCellValue('C3', "NOMOR POLISI");					$excel->getActiveSheet()->mergeCells('C3:C4');										$excel->setActiveSheetIndex(0)->setCellValue('D3', "MASA BERLAKU"); 					$excel->getActiveSheet()->mergeCells('D3:E3');					$excel->setActiveSheetIndex(0)->setCellValue('D4', "STNK"); 					$excel->setActiveSheetIndex(0)->setCellValue('E4', "PAJAK");					$excel->setActiveSheetIndex(0)->setCellValue('F3', "KONDISI KENDARAAN");					$excel->getActiveSheet()->mergeCells('F3:J3');					$excel->setActiveSheetIndex(0)->setCellValue('F4', "BADAN"); 					$excel->setActiveSheetIndex(0)->setCellValue('G4', "BAN"); 					$excel->setActiveSheetIndex(0)->setCellValue('H4', "INTERIOR"); 					$excel->setActiveSheetIndex(0)->setCellValue('I4', "MESIN"); 					$excel->setActiveSheetIndex(0)->setCellValue('J4', "PANEL"); 					$excel->setActiveSheetIndex(0)->setCellValue('K3', "CATATAN GA");					$excel->getActiveSheet()->mergeCells('K3:K4');					$excel->setActiveSheetIndex(0)->setCellValue('L3', "SARAN");					$excel->getActiveSheet()->mergeCells('L3:L4');					// Apply style header yang telah kita buat tadi ke masing-masing kolom header					$excel->getActiveSheet()->getStyle('A3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('A4')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('B3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('B4')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('C3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('C4')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('D3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('D4')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('E3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('G3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('H3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('I3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('J3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('E4')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('F3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('F4')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('G4')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('H4')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('I4')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('J4')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('K3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('K4')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('L3')->applyFromArray($style_judul);					$excel->getActiveSheet()->getStyle('L4')->applyFromArray($style_judul);					// Panggil function view yang ada di SiswaModel untuk menampilkan semua data siswanya					$kondisikendaraan = $this->model_cetak->tampil_datacetak('kondisi_kendaraan',$filter,'Nama_Kendaraan', $alias);					$no = 1; // Untuk penomoran tabel, di awal set dengan 1					$numrow = 5; // Set baris pertama untuk isi tabel adalah baris ke 4					foreach($kondisikendaraan as $data){ // Lakukan looping pada variabel siswa					  $excel->setActiveSheetIndex(0)->setCellValue('A'.$numrow, $no);					  $excel->setActiveSheetIndex(0)->setCellValue('B'.$numrow, $data->Nama_Kendaraan);					  $excel->setActiveSheetIndex(0)->setCellValue('C'.$numrow, $data->Nomor_Polisi);					  $excel->setActiveSheetIndex(0)->setCellValue('D'.$numrow, $data->Masa_Berlaku_STNK);					  $excel->setActiveSheetIndex(0)->setCellValue('E'.$numrow, $data->Masa_Berlaku_Pajak);					  $excel->setActiveSheetIndex(0)->setCellValue('F'.$numrow, $data->Kondisi_Badan_Kendaraan);					  $excel->setActiveSheetIndex(0)->setCellValue('G'.$numrow, $data->Kondisi_Ban_Kendaraan);					  $excel->setActiveSheetIndex(0)->setCellValue('H'.$numrow, $data->Kondisi_Interior_Kendaraan);					  $excel->setActiveSheetIndex(0)->setCellValue('I'.$numrow, $data->Kondisi_Mesin_Kendaraan);					  $excel->setActiveSheetIndex(0)->setCellValue('J'.$numrow, $data->Kondisi_Panel_Kendaraan);					  $excel->setActiveSheetIndex(0)->setCellValue('K'.$numrow, $data->Catatan_GA_Kendaraan);					  $excel->setActiveSheetIndex(0)->setCellValue('L'.$numrow, $data->Saran_Kendaraan);					  // Apply style row yang telah kita buat tadi ke masing-masing baris (isi tabel)					  $excel->getActiveSheet()->getStyle('A'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('B'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('C'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('D'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('E'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('F'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('G'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('H'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('I'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('J'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('K'.$numrow)->applyFromArray($style);					  $excel->getActiveSheet()->getStyle('L'.$numrow)->applyFromArray($style);					  $no++; // Tambah 1 setiap kali looping					  $numrow++; // Tambah 1 setiap kali looping					  $barisakhir = $numrow;					}										// Set width kolom					$excel->getActiveSheet()->getColumnDimension('A')->setWidth(5); // Set width kolom A					$excel->getActiveSheet()->getColumnDimension('B')->setWidth(30); // Set width kolom B					$excel->getActiveSheet()->getColumnDimension('C')->setWidth(25); // Set width kolom C					$excel->getActiveSheet()->getColumnDimension('D')->setWidth(30); // Set width kolom D					$excel->getActiveSheet()->getColumnDimension('E')->setWidth(30); // Set width kolom E					$excel->getActiveSheet()->getColumnDimension('F')->setWidth(10); // Set width kolom F					$excel->getActiveSheet()->getColumnDimension('G')->setWidth(10); // Set width kolom G					$excel->getActiveSheet()->getColumnDimension('H')->setWidth(10); // Set width kolom H					$excel->getActiveSheet()->getColumnDimension('I')->setWidth(10); // Set width kolom H					$excel->getActiveSheet()->getColumnDimension('J')->setWidth(10); // Set width kolom H					$excel->getActiveSheet()->getColumnDimension('K')->setWidth(30); // Set width kolom H					$excel->getActiveSheet()->getColumnDimension('L')->setWidth(30); // Set width kolom H					// Set height semua kolom menjadi auto (mengikuti height isi dari kolommnya, jadi otomatis)					$excel->getActiveSheet()->getDefaultRowDimension()->setRowHeight(-1);					// Set orientasi kertas jadi LANDSCAPE					$excel->getActiveSheet()->getPageSetup()->setOrientation(PHPExcel_Worksheet_PageSetup::ORIENTATION_LANDSCAPE);					// Set judul file excel nya					$excel->getActiveSheet(0)->setTitle("Laporan Kondisi Kendaraan");					$excel->setActiveSheetIndex(0);					// Proses file excel					header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');					$namapdf = 'Laporan Kondisi Kendaraan ['.$bulan.'-'.$pecah[1].'].xlsx';					header('Content-Disposition: attachment; filename="'.$namapdf.'"'); // Set nama file excel nya					header('Cache-Control: max-age=0');					$write = PHPExcel_IOFactory::createWriter($excel, 'Excel2007');					$write->save('php://output');																	}        }        else {            redirect(base_url());        }	}}